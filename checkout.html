<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Checkout - You're So Golden
  </title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <script type="module">
   import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA6kN9-7dN9Ovq6BmWBBJwBhLXRW6INX4c",
      authDomain: "daisy-s-website.firebaseapp.com",
      projectId: "daisy-s-website",
      storageBucket: "daisy-s-website.appspot.com",
      messagingSenderId: "595443495060",
      appId: "1:595443495060:web:7bbdd1108ad336d55c8481"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.submitOrder = async () => {
      const name = document.getElementById("cust-name").value.trim();
      const email = document.getElementById("cust-email").value.trim();
      const basket = JSON.parse(localStorage.getItem("daisyCart")) || [];

      if (!name || !email || basket.length === 0) {
        alert("Please enter name, email, and make sure your basket isn't empty.");
        return;
      }

      try {
        await addDoc(collection(db, "orders"), {
          name,
          email,
          items: basket,
          createdAt: new Date().toISOString()
        });

        alert("Order placed successfully! Thank you ðŸŒŸ");
        localStorage.removeItem("daisyCart");
        window.location.href = "thankyou.html";
      } catch (err) {
        alert("Failed to submit order. Try again.");
        console.error(err);
      }
    };
  </script>
  <link href="styles.css" rel="stylesheet"/>
 </head>
 <body>
  <div class="announcement-bar">
   Free shipping on all UK orders over Â£25
  </div>
  <header class="site-header">
   <div class="header-left">
    <a href="#">
     <i class="fab fa-instagram">
     </i>
    </a>
    <a href="#">
     <i class="fab fa-facebook-f">
     </i>
    </a>
    <a href="#">
     <i class="fas fa-phone">
     </i>
    </a>
    <a href="#">
     <i class="fas fa-envelope">
     </i>
    </a>
   </div>
   <h1 class="header-title">
    <a class="logo-link" href="index.html">
     You're So Golden
    </a>
   </h1>
   <div class="header-right">
    <a class="cart-icon" href="basket.html">
     <i class="fas fa-basket-shopping">
     </i>
    </a>
    <a class="login-icon" href="account.html">
     <i class="fas fa-user">
     </i>
    </a>
   </div>
  </header>
  <nav class="nav-links">
   <a href="index.html">
    Home
   </a>
   <a href="shop.html">
    Shop
   </a>
   <a href="#">
    About
   </a>
   <a href="contacts.html">
    Contact
   </a>
  </nav>
  <div class="checkout-container">
   <h2>
    Checkout
   </h2>
   <div id="basket-summary">
   </div>
   <div id="subtotal-display">
   </div>
   <form onsubmit="event.preventDefault(); submitOrder();">
    <input id="cust-name" placeholder="Your Full Name" required="" type="text"/>
    <input id="cust-email" placeholder="Your Email Address" required="" type="email"/>
    <button type="submit">
     Place Order
    </button>
   </form>
  </div>
  <footer>
   Â© 2025 You're So Golden Â· All Rights Reserved
  </footer>
  <script>
   const basket = JSON.parse(localStorage.getItem("daisyCart")) || [];
    const summary = document.getElementById("basket-summary");
    const subtotalDisplay = document.getElementById("subtotal-display");

    function renderBasket() {
      let subtotal = 0;
      summary.innerHTML = "";

      if (basket.length === 0) {
        summary.innerHTML = "<p>Your basket is empty.</p>";
        return;
      }

      basket.forEach(item => {
        subtotal += item.qty * item.price;
        const div = document.createElement("div");
        div.className = "basket-item";
        div.innerHTML = `
          <img src="${item.image}" alt="${item.name}">
          <div class="basket-details">
            <span class="item-name">${item.name} Ã— ${item.qty}</span>
            <span class="item-price">Â£${(item.price * item.qty).toFixed(2)}</span>
          </div>
        `;
        summary.appendChild(div);
      });

      subtotalDisplay.textContent = `Subtotal: Â£${subtotal.toFixed(2)}`;
    }

    renderBasket();
  </script>
 </body>
</html>
